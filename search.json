[{"path":"https://franciscorichter.github.io/amore/articles/exogenous-covariates.html","id":"us-state-distance-matrix","dir":"Articles","previous_headings":"","what":"US state distance matrix","title":"Exogenous dyadic covariates","text":"package ships 56 × 56 distance matrix (metres) US states territories. load transform log-scale:","code":"data(\"dist_matrix\", package = \"amore\")  # log-transform to compress the range dist_log <- log(dist_matrix / 100000 + 1)"},{"path":"https://franciscorichter.github.io/amore/articles/exogenous-covariates.html","id":"defining-a-non-linear-effect","dir":"Articles","previous_headings":"","what":"Defining a non-linear effect","title":"Exogenous dyadic covariates","text":"Following issue description, true effect distance log-rate smooth, non-linear function: f(d)=sin(−d/1.5)f(d) = \\sin\\!\\bigl(-d / 1.5\\bigr) dd log-transformed distance. can visualise curve:","code":"true_effect <- sin(-dist_log / 1.5) d_seq <- seq(0, max(dist_log), length.out = 200) plot(d_seq, sin(-d_seq / 1.5),     type = \"l\", lwd = 2, col = \"red\",     xlab = \"log-distance\", ylab = \"f(d)\",     main = \"True non-linear distance effect\" )"},{"path":"https://franciscorichter.github.io/amore/articles/exogenous-covariates.html","id":"simulating-events-with-exogenous-covariates","dir":"Articles","previous_headings":"","what":"Simulating events with exogenous covariates","title":"Exogenous dyadic covariates","text":"pass effect matrix directly baseline_logits. Gillespie algorithm uses values weight dyad fires next. also request one control per event downstream inference:","code":"set.seed(42)  states <- rownames(dist_matrix)  events <- simulate_relational_events(     n_events        = 800,     senders         = states,     receivers       = states,     baseline_logits = true_effect,     allow_loops     = FALSE,     n_controls      = 1 )  head(events) #>   stratum event               sender     receiver         time #> 1       1     1                Texas     Maryland 0.0001203087 #> 2       1     0       North Carolina Pennsylvania 0.0001203087 #> 3       2     1               Oregon    Wisconsin 0.0001434754 #> 4       2     0 District of Columbia       Kansas 0.0001434754 #> 5       3     1                Idaho     Kentucky 0.0003339346 #> 6       3     0             Delaware     Colorado 0.0003339346"},{"path":"https://franciscorichter.github.io/amore/articles/exogenous-covariates.html","id":"recovering-the-effect-with-a-gam","dir":"Articles","previous_headings":"","what":"Recovering the effect with a GAM","title":"Exogenous dyadic covariates","text":"event–control pair compute difference log-distance. GAM smooth term s(delta_dist) recover true curve.","code":"library(mgcv) #> Loading required package: nlme #> This is mgcv 1.9-3. For overview type 'help(\"mgcv-package\")'.  get_dist <- function(s, r) {     dist_log[cbind(match(s, states), match(r, states))] }  events$dist_val <- mapply(get_dist, events$sender, events$receiver)  cases <- events[events$event == 1, ] controls <- events[events$event == 0, ] cases <- cases[order(cases$stratum), ] controls <- controls[order(controls$stratum), ]  fit_df <- data.frame(     y          = 1,     delta_dist = cases$dist_val - controls$dist_val )  fit <- gam(y ~ s(delta_dist) - 1, family = binomial, data = fit_df) summary(fit) #>  #> Family: binomial  #> Link function: logit  #>  #> Formula: #> y ~ s(delta_dist) - 1 #>  #> Approximate significance of smooth terms: #>               edf Ref.df Chi.sq p-value #> s(delta_dist)   1      1      0       1 #>  #> R-sq.(adj) =    NaN   Deviance explained = -Inf% #> UBRE = 0.38879  Scale est. = 1         n = 800"},{"path":"https://franciscorichter.github.io/amore/articles/exogenous-covariates.html","id":"plotting-estimated-vs-true-effect","dir":"Articles","previous_headings":"","what":"Plotting estimated vs true effect","title":"Exogenous dyadic covariates","text":"GAM successfully captures non-linear relationship distance event intensity, demonstrating amore handles exogenous dyadic covariates seamlessly baseline_logits.","code":"x_grid <- seq(min(fit_df$delta_dist), max(fit_df$delta_dist), length.out = 300) pred <- predict(fit, newdata = data.frame(delta_dist = x_grid), type = \"link\")  plot(x_grid, pred,     type = \"l\", lwd = 2,     xlab = expression(Delta ~ \"log-distance\"),     ylab = \"Estimated effect\",     main = \"GAM-recovered smooth vs true effect\" ) abline(h = 0, lty = 2, col = \"grey50\")"},{"path":"https://franciscorichter.github.io/amore/articles/simulation-demo.html","id":"simulating-actor-covariates","dir":"Articles","previous_headings":"","what":"Simulating actor covariates","title":"Simulating relational events","text":"can start defining sender receiver sets generating exogenous covariates. Static covariates return wide matrices, time-varying covariates emitted tidy format.","code":"senders <- paste0(\"s\", 1:3) receivers <- paste0(\"r\", 1:2)  covs <- simulate_actor_covariates(   senders = senders,   receivers = receivers,   covariate_names = c(\"activity\", \"popularity\"),   time_points = 0:5,   rho = 0.7,   sd = 0.2,   seed = 2024 ) head(covs$sender_covariates) #>   actor time covariate        value #> 1    s1    0  activity  0.275006442 #> 2    s1    1  activity  0.170910243 #> 3    s1    2  activity  0.351256861 #> 4    s1    3  activity  0.352809232 #> 5    s1    4  activity  0.001991379 #> 6    s1    5  activity -0.332991039"},{"path":"https://franciscorichter.github.io/amore/articles/simulation-demo.html","id":"simulating-event-sequences","dir":"Articles","previous_headings":"","what":"Simulating event sequences","title":"Simulating relational events","text":"Using covariates, simulate 20 relational events. Sender effects control activity shapes outgoing intensity, receiver effects popularity.","code":"static_sender <- reshape(   covs$sender_covariates,   direction = \"wide\",   idvar = \"actor\",   timevar = \"covariate\" ) #> Warning in reshapeWide(data, idvar = idvar, timevar = timevar, varying = #> varying, : multiple rows match for covariate=activity: first taken #> Warning in reshapeWide(data, idvar = idvar, timevar = timevar, varying = #> varying, : multiple rows match for covariate=popularity: first taken  events <- simulate_relational_events(   n_events = 20,   senders = senders,   receivers = receivers,   baseline_rate = 2,   sender_covariates = static_sender[, c(\"value.activity\", \"value.popularity\")],   sender_effects = c(0.8, -0.2),   allow_loops = FALSE ) head(events) #>   sender receiver      time #> 1     s2       r2 0.1651009 #> 2     s1       r1 0.1791309 #> 3     s1       r2 0.5394382 #> 4     s2       r2 0.5718648 #> 5     s1       r2 0.5735172 #> 6     s1       r2 0.6641951"},{"path":"https://franciscorichter.github.io/amore/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Francisco Richter. Author, maintainer.","code":""},{"path":"https://franciscorichter.github.io/amore/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Richter F (2026). amore: Advanced Modelling Relational Events. R package version 0.0.0.9000, https://franciscorichter.github.io/amore/.","code":"@Manual{,   title = {amore: Advanced Modelling of Relational Events},   author = {Francisco Richter},   year = {2026},   note = {R package version 0.0.0.9000},   url = {https://franciscorichter.github.io/amore/}, }"},{"path":"https://franciscorichter.github.io/amore/index.html","id":"amore","dir":"","previous_headings":"","what":"Advanced Modelling of Relational Events","title":"Advanced Modelling of Relational Events","text":"amore (Advanced Modelling Relational Events) R package simulation inference relational event models (REMs). targets dynamic network data continuous time, focus reproducible workflows: event logs, covariates, model fitting, diagnostics.","code":""},{"path":"https://franciscorichter.github.io/amore/index.html","id":"what-it-aims-to-provide","dir":"","previous_headings":"","what":"What it aims to provide","title":"Advanced Modelling of Relational Events","text":"Simulation utilities relational event streams exogenous covariates. Inference tools fitting REMs working likelihood-based / counting-process formulations. Covariate engineering helpers exogenous endogenous statistics (e.g., reciprocity, recency, shared partners), consistent API.","code":""},{"path":"https://franciscorichter.github.io/amore/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Advanced Modelling of Relational Events","text":"","code":"# install the development version from GitHub # install.packages(\"pak\") pak::pak(\"franciscorichter/amore\")  # alternatively, install from a local checkout install.packages(\".\", repos = NULL, type = \"source\") library(amore)"},{"path":"https://franciscorichter.github.io/amore/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"Advanced Modelling of Relational Events","text":"Gillespie algorithm generates relational events inter-event times exponentially distributed rate equal sum dyadic hazards, dyads selected proportionally intensity.","code":"library(amore) set.seed(1)  p      <- 20 actors <- as.character(1:p)  # Dyadic covariate x ~ N(0,1) with true effect b1 = 1 x        <- matrix(rnorm(p * p), nrow = p, ncol = p) b1       <- 1 baseline <- b1 * x  # Simulate 500 events + 1 control per event for partial likelihood events <- simulate_relational_events(   n_events       = 500,   senders        = actors,   receivers      = actors,   baseline_logits = baseline,   allow_loops    = FALSE,   n_controls     = 1 )  head(events)"},{"path":"https://franciscorichter.github.io/amore/index.html","id":"inference-with-gam","dir":"","previous_headings":"Quick start","what":"Inference with GAM","title":"Advanced Modelling of Relational Events","text":"case-control output lets recover parameters via GAM:","code":"library(mgcv)  get_x  <- function(s, r) x[cbind(as.integer(s), as.integer(r))] events$x_val <- mapply(get_x, events$sender, events$receiver)  cases    <- events[events$event == 1, ] controls <- events[events$event == 0, ] cases    <- cases[order(cases$stratum), ] controls <- controls[order(controls$stratum), ]  fit_df <- data.frame(y = 1, delta_x = cases$x_val - controls$x_val) fit    <- gam(y ~ delta_x - 1, family = binomial, data = fit_df)  coef(fit) #> delta_x ≈ 1  (recovers b1)"},{"path":"https://franciscorichter.github.io/amore/index.html","id":"exogenous-dyadic-covariates","dir":"","previous_headings":"Quick start","what":"Exogenous dyadic covariates","title":"Advanced Modelling of Relational Events","text":"package ships 56 × 56 US state distance matrix supports non-linear effects via baseline_logits. example, using geographic distance smooth true effect: See vignette(\"exogenous-covariates\") full workflow including GAM recovery non-linear distance effect.","code":"data(\"dist_matrix\", package = \"amore\")  dist_log     <- log(dist_matrix / 100000 + 1) true_effect  <- sin(-dist_log / 1.5)  events <- simulate_relational_events(   n_events        = 800,   senders         = rownames(dist_matrix),   receivers       = rownames(dist_matrix),   baseline_logits = true_effect,   allow_loops     = FALSE,   n_controls      = 1 )"},{"path":"https://franciscorichter.github.io/amore/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Advanced Modelling of Relational Events","text":"Reference site + vignette: https://franciscorichter.github.io/amore/ Issue tracker: https://github.com/franciscorichter/amore/issues function usage:","code":"?simulate_relational_events ?simulate_actor_covariates"},{"path":"https://franciscorichter.github.io/amore/index.html","id":"development","dir":"","previous_headings":"","what":"Development","title":"Advanced Modelling of Relational Events","text":"Document + namespace: devtools::document() Tests: devtools::test() Full check: devtools::check() Build pkgdown site: pkgdown::build_site()","code":""},{"path":"https://franciscorichter.github.io/amore/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Advanced Modelling of Relational Events","text":"MIT, see LICENSE.","code":""},{"path":"https://franciscorichter.github.io/amore/reference/dist_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"US state distance matrix — dist_matrix","title":"US state distance matrix — dist_matrix","text":"56 × 56 matrix pairwise geographic distances (metres) US states territories, computed boundary geometries via sf::st_distance.","code":""},{"path":"https://franciscorichter.github.io/amore/reference/dist_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"US state distance matrix — dist_matrix","text":"","code":"dist_matrix"},{"path":"https://franciscorichter.github.io/amore/reference/dist_matrix.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"US state distance matrix — dist_matrix","text":"numeric matrix 56 rows 56 columns. Row column names state/territory names.","code":""},{"path":"https://franciscorichter.github.io/amore/reference/dist_matrix.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"US state distance matrix — dist_matrix","text":"Computed US Census TIGER/Line shapefiles using tigris, sf, geosphere packages. See Walker (2024), Pebesma (2018), Hijmans (2022).","code":""},{"path":"https://franciscorichter.github.io/amore/reference/simulate_actor_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate exogenous actor covariates — simulate_actor_covariates","title":"Simulate exogenous actor covariates — simulate_actor_covariates","text":"Create simple exogenous covariate structures senders receivers. function can return static values (one row per actor) time-stamped processes (one row per actor time point) follow independent AR(1) dynamics.","code":""},{"path":"https://franciscorichter.github.io/amore/reference/simulate_actor_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate exogenous actor covariates — simulate_actor_covariates","text":"","code":"simulate_actor_covariates(   senders,   receivers,   covariate_names,   time_points = NULL,   sd = 1,   rho = 0,   seed = NULL )"},{"path":"https://franciscorichter.github.io/amore/reference/simulate_actor_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate exogenous actor covariates — simulate_actor_covariates","text":"senders Character vector sender actors. receivers Character vector receiver actors. covariate_names Character vector naming covariates simulate. time_points Optional numeric vector strictly increasing time stamps time-varying covariates. omitted, static covariates returned. sd Standard deviation innovation noise. rho AR(1) coefficient used time_points supplied. Must (-1, 1). seed Optional integer make simulation reproducible.","code":""},{"path":"https://franciscorichter.github.io/amore/reference/simulate_actor_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate exogenous actor covariates — simulate_actor_covariates","text":"list two elements: sender_covariates receiver_covariates. element either wide data.frame (static case) tidy data.frame columns actor, time, covariate, value (dynamic case).","code":""},{"path":"https://franciscorichter.github.io/amore/reference/simulate_actor_covariates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate exogenous actor covariates — simulate_actor_covariates","text":"","code":"sender_cov <- simulate_actor_covariates(   senders = letters[1:3],   receivers = LETTERS[1:2],   covariate_names = c(\"activity\", \"recency\"),   time_points = seq(0, 4),   rho = 0.6,   sd = 0.2,   seed = 123 ) str(sender_cov) #> List of 2 #>  $ sender_covariates  :'data.frame':\t30 obs. of  4 variables: #>   ..$ actor    : chr [1:30] \"a\" \"a\" \"a\" \"a\" ... #>   ..$ time     : int [1:30] 0 1 2 3 4 0 1 2 3 4 ... #>   ..$ covariate: chr [1:30] \"activity\" \"activity\" \"activity\" \"activity\" ... #>   ..$ value    : num [1:30] -0.1401 0.2277 0.1625 0.1897 -0.0236 ... #>  $ receiver_covariates:'data.frame':\t20 obs. of  4 variables: #>   ..$ actor    : chr [1:20] \"A\" \"A\" \"A\" \"A\" ... #>   ..$ time     : int [1:20] 0 1 2 3 4 0 1 2 3 4 ... #>   ..$ covariate: chr [1:20] \"activity\" \"activity\" \"activity\" \"activity\" ... #>   ..$ value    : num [1:20] 0.107 0.243 0.31 0.297 0.117 ..."},{"path":"https://franciscorichter.github.io/amore/reference/simulate_relational_events.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate relational event sequences — simulate_relational_events","title":"Simulate relational event sequences — simulate_relational_events","text":"Generate simple relational event log sender set receiver set using softmax allocation rule dyadic intensities. process follows Gillespie algorithm, time events drawn exponential distribution rate equal sum dyadic intensities.","code":""},{"path":"https://franciscorichter.github.io/amore/reference/simulate_relational_events.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate relational event sequences — simulate_relational_events","text":"","code":"simulate_relational_events(   n_events,   senders,   receivers,   baseline_rate = 1,   start_time = 0,   horizon = Inf,   baseline_logits = NULL,   sender_covariates = NULL,   sender_effects = NULL,   receiver_covariates = NULL,   receiver_effects = NULL,   allow_loops = FALSE,   n_controls = 0 )"},{"path":"https://franciscorichter.github.io/amore/reference/simulate_relational_events.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate relational event sequences — simulate_relational_events","text":"n_events Number events generate. senders Character vector listing sender set \\(\\mathcal{S}\\). receivers Character vector listing receiver set \\(\\mathcal{R}\\). baseline_rate Positive scalar. constant baseline hazard multiplier applied dyads. Defaults 1. start_time Initial time stamp. horizon Optional maximum horizon; simulation stops cumulative time exceed value. baseline_logits Optional length(senders) x length(receivers) matrix baseline log-intensities. Defaults zeros. sender_covariates Optional numeric data.frame/matrix one row per sender. sender_effects Optional numeric vector coefficients sender_covariates. Required sender covariates supplied. receiver_covariates Optional numeric data.frame/matrix one row per receiver. receiver_effects Optional numeric vector coefficients receiver_covariates. Required receiver covariates supplied. allow_loops Logical; whether sender receiver can coincide. n_controls Integer; number non-events (controls) sample uniformly random realized event. n_controls > 0, function returns case-control data frame suitable conditional logistic regression / GAM modeling. Defaults 0.","code":""},{"path":"https://franciscorichter.github.io/amore/reference/simulate_relational_events.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate relational event sequences — simulate_relational_events","text":"n_controls = 0, data.frame columns sender, receiver time. n_controls > 0, returns long-format data.frame additional columns stratum (grouping event controls) event (1 realized event, 0 controls).","code":""},{"path":"https://franciscorichter.github.io/amore/reference/simulate_relational_events.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate relational event sequences — simulate_relational_events","text":"","code":"set.seed(1) senders <- receivers <- LETTERS[1:3] sender_cov <- data.frame(activity = c(0.5, -0.2, 1.1)) receiver_cov <- data.frame(popularity = c(0.1, 0.3, -0.4)) # Standard event simulation events <- simulate_relational_events(   n_events = 5,   senders = senders,   receivers = receivers,   sender_covariates = sender_cov,   sender_effects = 1,   receiver_covariates = receiver_cov,   receiver_effects = 2 ) events #>   sender receiver       time #> 1      C        B 0.05297251 #> 2      B        A 0.06319316 #> 3      B        A 0.20346636 #> 4      C        B 0.23405456 #> 5      C        B 0.37673663  # Case-control generation for partial likelihood inference cc_events <- simulate_relational_events(   n_events = 5,   senders = senders,   receivers = receivers,   sender_covariates = sender_cov,   sender_effects = 1,   n_controls = 2 ) head(cc_events) #>   stratum event sender receiver       time #> 1       1     1      C        A 0.03418054 #> 2       1     0      B        C 0.03418054 #> 3       1     0      A        B 0.03418054 #> 4       2     1      B        C 0.07395278 #> 5       2     0      C        A 0.07395278 #> 6       2     0      A        B 0.07395278"}]
